<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&family=Montserrat:wght@400;700&family=Orbitron:wght@400;700&family=Oswald:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root { --bg-color: #050b18; --text-color: #ffffff; --accent-color: #3a86ff; --font-main: 'Roboto', sans-serif; --btn-radius: 12px; }
        body { margin: 0; padding: 0; font-family: var(--font-main); background-color: var(--bg-color); color: var(--text-color); transition: all 0.3s ease; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
        #stars-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%); }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0.5; animation: twinkle 5s infinite; }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
        .screen { display: none; padding: 20px; min-height: 100vh; box-sizing: border-box; flex-direction: column; align-items: center; }
        .active { display: flex; }
        .btn { background-color: var(--accent-color); color: #fff; border: none; padding: 15px; border-radius: var(--btn-radius); font-size: 16px; width: 100%; max-width: 400px; margin-bottom: 12px; cursor: pointer; font-weight: bold; }
        input { width: 100%; max-width: 400px; padding: 12px; margin-bottom: 20px; border-radius: 10px; border: 1px solid #3a86ff; background: rgba(255,255,255,0.1); color: white; font-size: 16px; }
        .top-bar { display: flex; justify-content: space-between; width: 100%; max-width: 400px; background: rgba(255,255,255,0.1); padding: 10px; border-radius: 15px; margin-bottom: 20px; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.1); }
        .theory-card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-bottom: 20px; width: 100%; box-sizing: border-box; backdrop-filter: blur(10px); }
        .katex-display { overflow-x: auto; padding: 10px 0; text-align: left !important; }
        body.class-5 { --accent-color: #FF6F00; --font-main: 'Nunito'; }
        body.class-6 { --accent-color: #651FFF; --font-main: 'Montserrat'; }
        body.class-7 { --accent-color: #d60270; --font-main: 'Orbitron'; }
        body.class-8 { --accent-color: #FFD600; --font-main: 'Oswald'; }
    </style>
</head>
<body>
    <div id="stars-canvas"></div>

    <div id="screen-welcome" class="screen active">
        <h1 style="font-size: 32px; color: #3a86ff;">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è</h1>
        <input type="text" id="username-input" placeholder="–ò–º—è –∫—É—Ä—Å–∞–Ω—Ç–∞...">
        <h3>–í—ã–±–µ—Ä–∏ —Å–≤–æ–π –∫–ª–∞—Å—Å:</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width:100%; max-width:400px;">
            <button class="btn" style="background: #FF6F00" onclick="selectClass(5)">5 –∫–ª–∞—Å—Å</button>
            <button class="btn" style="background: #651FFF" onclick="selectClass(6)">6 –∫–ª–∞—Å—Å</button>
            <button class="btn" style="background: #d60270" onclick="selectClass(7)">7 –∫–ª–∞—Å—Å</button>
            <button class="btn" style="background: #000; color:#FFD600; border:1px solid #FFD600" onclick="selectClass(8)">8 –∫–ª–∞—Å—Å</button>
            <button class="btn" style="background: #007AFF" onclick="selectClass(9)">9 –∫–ª–∞—Å—Å</button>
            <button class="btn" style="background: #7B8D76" onclick="selectClass(10)">10 –∫–ª–∞—Å—Å</button>
            <button class="btn" style="background: #1e293b" onclick="selectClass(11)">11 –∫–ª–∞—Å—Å</button>
        </div>
    </div>

    <div id="screen-menu" class="screen">
        <div class="top-bar"><div>‚ù§Ô∏è <span id="lives-display">5</span></div><div>ü™ô <span id="coins-display">0</span></div></div>
        <h1 id="welcome-text"></h1>
        <div style="width:100%; max-width:400px;">
            <button class="btn" onclick="showTheorySelection()">üìö –¢–µ–æ—Ä–∏—è (7 –±–ª–æ–∫–æ–≤)</button>
            <button class="btn" onclick="startPractice()">‚úèÔ∏è –ü—Ä–∞–∫—Ç–∏–∫–∞</button>
            <button class="btn" style="background:transparent; border:1px solid #444;" onclick="changeClass()">‚Ü© –°–º–µ–Ω–∏—Ç—å –∫–ª–∞—Å—Å</button>
        </div>
    </div>

    <div id="screen-theory-select" class="screen">
        <div class="top-bar"><button class="btn" style="width:auto; margin:0;" onclick="showScreen('screen-menu')">‚¨Ö –ù–∞–∑–∞–¥</button></div>
        <h2>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: 7 –°–µ–∫—Ç–æ—Ä–æ–≤</h2>
        <div id="topics-list" style="width:100%; max-width:400px;"></div>
    </div>

    <div id="screen-theory-read" class="screen">
        <div class="top-bar"><button class="btn" style="width:auto; margin:0;" onclick="showTheorySelection()">‚¨Ö –ö —Å–µ–∫—Ç–æ—Ä–∞–º</button></div>
        <div id="theory-content" class="theory-card"></div>
        <button class="btn" onclick="startPractice()">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç –ø–æ —Ç–µ–º–µ</button>
    </div>

    <div id="screen-practice" class="screen">
        <div class="top-bar"><div>‚ù§Ô∏è <span id="quiz-lives">5</span></div><div>ü™ô <span id="quiz-coins">0</span></div></div>
        <div class="theory-card"><h3 id="question-text">–°–≤—è–∑—å —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–º...</h3></div>
        <div id="answers-block" style="width:100%; max-width:400px;"></div>
        <div id="feedback-block" style="display:none; padding:15px; background:rgba(255,255,255,0.95); border-radius:10px; color:#000; width:100%; max-width:400px;">
            <strong id="feedback-title"></strong>
            <p id="feedback-solution" style="font-size:15px; line-height:1.4;"></p>
            <button class="btn" id="next-q-btn">–î–∞–ª–µ–µ ‚û°</button>
        </div>
    </div>

    <div id="screen-results" class="screen"><h1 id="result-message"></h1><button class="btn" onclick="showScreen('screen-menu')">üè† –í –º–µ–Ω—é</button></div>

    <script>
        const tg = window.Telegram.WebApp; tg.expand();
        function createStars() { const c = document.getElementById('stars-canvas'); for (let i = 0; i < 70; i++) { const s = document.createElement('div'); s.className = 'star'; const size = Math.random() * 3 + 'px'; s.style.width = size; s.style.height = size; s.style.left = Math.random() * 100 + '%'; s.style.top = Math.random() * 100 + '%'; s.style.animationDelay = Math.random() * 5 + 's'; c.appendChild(s); } } createStars();
        
        const theoryData = {
            5: [
                { title: "1. –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞", content: String.raw`a+b=b+a \\ (a+b)+c=a+(b+c) \\ a \cdot b = b \cdot a \\ (a \cdot b) \cdot c = a \cdot (b \cdot c) \\ a(b+c)=ab+ac \\ a-b-c = a-(b+c) \\ a:b=q (–æ—Å—Ç. r)` },
                { title: "2. –ì–µ–æ–º–µ—Ç—Ä–∏—è (–±–∞–∑–∞)", content: String.raw`P = 2(a+b) \\ P = 4a \\ S = a \cdot b \\ S = a^2 \\ V = abc \\ V = a^3 \\ S_{–ø–æ–≤} = 6a^2` },
                { title: "3. –ó–∞–¥–∞—á–∏ –Ω–∞ –¥–≤–∏–∂–µ–Ω–∏–µ", content: String.raw`s = v \cdot t \\ v = s/t \\ t = s/v \\ v_{–ø–æ} = v_{—Å–æ–±} + v_{—Ç–µ—á} \\ v_{–ø—Ä} = v_{—Å–æ–±} - v_{—Ç–µ—á} \\ v_{—Å–±–ª} = v_1 + v_2 \\ v_{—É–¥} = v_1 - v_2` },
                { title: "4. –û–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã–µ –¥—Ä–æ–±–∏", content: String.raw`\frac{a}{c} + \frac{b}{c} = \frac{a+b}{c} \\ \frac{a}{c} - \frac{b}{c} = \frac{a-b}{c} \\ \frac{a}{a} = 1 \\ \frac{0}{b} = 0 \\ a \frac{b}{c} = \frac{ac+b}{c} \\ \text{–ß–∞—Å—Ç—å –æ—Ç —á–∏—Å–ª–∞: } n \cdot \frac{a}{b} \\ \text{–ß–∏—Å–ª–æ –ø–æ —á–∞—Å—Ç–∏: } m : \frac{a}{b}` },
                { title: "5. –î–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏", content: String.raw`a,bc + d,ef \\ a,bc \cdot 10^n \\ a,bc : 10^n \\ \text{–û–∫—Ä—É–≥–ª–µ–Ω–∏–µ: } 5 \uparrow, 4 \downarrow \\ \text{–°—Ä–µ–¥–Ω–µ–µ: } \frac{\sum x}{n} \\ a,b \cdot c,d \\ a,b : c,d` },
                { title: "6. –ü—Ä–æ—Ü–µ–Ω—Ç—ã", content: String.raw`1\% = 0,01 \\ 100\% = 1 \\ 50\% = 1/2 \\ 25\% = 1/4 \\ 20\% = 1/5 \\ 10\% = 0,1 \\ \text{–ù–∞–π—Ç–∏ } p\% \text{: } n \cdot 0,0p` },
                { title: "7. –ò–∑–º–µ—Ä–µ–Ω–∏—è", content: String.raw`1 \text{ –∫–º} = 1000 \text{ –º} \\ 1 \text{ –º} = 100 \text{ —Å–º} \\ 1 \text{ –∫–≥} = 1000 \text{ –≥} \\ 1 \text{ —Ü} = 100 \text{ –∫–≥} \\ 1 \text{ —Ç} = 10 \text{ —Ü} \\ 1 \text{ –≥–∞} = 10000 \text{ –º}^2 \\ 1 \text{ –ª} = 1 \text{ –¥–º}^3` }
            ],
            6: [
                { title: "1. –î–µ–ª–∏–º–æ—Å—Ç—å", content: String.raw`a = b \cdot k \\ \text{–ü—Ä–∏–∑–Ω–∞–∫ 2: —á–µ—Ç–Ω—ã–µ} \\ \text{–ü—Ä–∏–∑–Ω–∞–∫ 3: } \sum cif : 3 \\ \text{–ü—Ä–∏–∑–Ω–∞–∫ 5: 0 –∏–ª–∏ 5} \\ \text{–ü—Ä–∏–∑–Ω–∞–∫ 9: } \sum cif : 9 \\ \text{–ü—Ä–∏–∑–Ω–∞–∫ 10: 0} \\ –ù–û–î \cdot –ù–û–ö = a \cdot b` },
                { title: "2. –î—Ä–æ–±–∏ (—É–º–Ω–æ–∂–µ–Ω–∏–µ)", content: String.raw`\frac{a}{b} \cdot \frac{c}{d} = \frac{ac}{bd} \\ \frac{a}{b} : \frac{c}{d} = \frac{ad}{bc} \\ (a/b)^n = a^n/b^n \\ \frac{a}{b} \cdot b = a \\ \text{–í–∑–∞–∏–º–Ω–æ –æ–±—Ä–∞—Ç–Ω—ã–µ: } x \cdot \frac{1}{x} = 1 \\ \frac{a}{b} = \frac{ac}{bc} \\ \text{–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ: } \frac{xa}{xb} = \frac{a}{b}` },
                { title: "3. –ü—Ä–æ–ø–æ—Ä—Ü–∏–∏", content: String.raw`a:b = c:d \\ ad = bc \\ a = \frac{bc}{d} \\ b = \frac{ad}{c} \\ k = a/b \\ \text{–ú–∞—Å—à—Ç–∞–±: } L_{map}/L_{real} \\ \text{–ü—Ä—è–º–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å: } y = kx` },
                { title: "4. –û–∫—Ä—É–∂–Ω–æ—Å—Ç—å –∏ –ö—Ä—É–≥", content: String.raw`D = 2r \\ C = \pi d \\ C = 2\pi r \\ S = \pi r^2 \\ \pi \approx 3,14 \\ \text{–î–ª–∏–Ω–∞ –¥—É–≥–∏: } \frac{\pi r \alpha}{180} \\ \text{–°–µ–∫—Ç–æ—Ä: } \frac{\pi r^2 \alpha}{360}` },
                { title: "5. –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ/–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ", content: String.raw`|a| = a, -a \\ a + (-b) = a - b \\ -a - b = -(a+b) \\ -a \cdot (-b) = ab \\ -a \cdot b = -ab \\ -a : (-b) = a/b \\ a : (-b) = -a/b` },
                { title: "6. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ", content: String.raw`A(x) \\ B(x;y) \\ \text{–û—Å—å –∞–±—Å—Ü–∏—Å—Å: } OX \\ \text{–û—Å—å –æ—Ä–¥–∏–Ω–∞—Ç: } OY \\ \text{–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: } |x_2 - x_1| \\ \text{–°–µ—Ä–µ–¥–∏–Ω–∞: } (x_1+x_2)/2 \\ \text{–ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ: } a, -a` },
                { title: "7. –í—ã—Ä–∞–∂–µ–Ω–∏—è –∏ –£—Ä–∞–≤–Ω–µ–Ω–∏—è", content: String.raw`a+(b-c)=a+b-c \\ a-(b-c)=a-b+c \\ a(b+c)=ab+ac \\ \text{–ü–æ–¥–æ–±–Ω—ã–µ: } 2x+3x=5x \\ x+a=b \Rightarrow x=b-a \\ x \cdot a=b \Rightarrow x=b/a \\ \text{–ü–µ—Ä–µ–Ω–æ—Å –∑–Ω–∞–∫–∞: } a \to -a` }
            ],
            7: [
                { title: "1. –õ–∏–Ω–µ–π–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è", content: String.raw`ax = b \\ x = b/a \text{ (a } \neq 0) \\ 0x = 0 \text{ (–ª—é–±–æ–µ x)} \\ 0x = b \text{ (–Ω–µ—Ç –∫–æ—Ä–Ω–µ–π)} \\ ax+b = cx+d \\ \text{–ö–æ—Ä–µ–Ω—å: –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π} \\ \text{–†–∞–≤–Ω–æ—Å–∏–ª—å–Ω—ã–µ: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–æ—Ä–Ω–∏}` },
                { title: "2. –°—Ç–µ–ø–µ–Ω—å —Å –Ω–∞—Ç. –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º", content: String.raw`a^n = a \cdot \dots \cdot a \\ a^n \cdot a^m = a^{n+m} \\ a^n : a^m = a^{n-m} \\ (a^n)^m = a^{nm} \\ (ab)^n = a^n b^n \\ (a/b)^n = a^n/b^n \\ a^0 = 1, a^1 = a` },
                { title: "3. –û–¥–Ω–æ—á–ª–µ–Ω—ã –∏ –ú–Ω–æ–≥–æ—á–ª–µ–Ω—ã", content: String.raw`2x^2 \cdot 3x^3 = 6x^5 \\ (2x)^3 = 8x^3 \\ \text{–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∏–¥: —á–∏—Å–ª–æ –ø–µ—Ä–≤—ã–º} \\ \text{–°—Ç–µ–ø–µ–Ω—å: —Å—É–º–º–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π} \\ a(b+c) = ab+ac \\ (a+b)(c+d) = ac+ad+bc+bd \\ \text{–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ: –≤—ã–Ω–æ—Å –∑–∞ —Å–∫–æ–±–∫–∏}` },
                { title: "4. –§–°–£ (–ö–≤–∞–¥—Ä–∞—Ç—ã)", content: String.raw`(a+b)^2 = a^2+2ab+b^2 \\ (a-b)^2 = a^2-2ab+b^2 \\ a^2-b^2 = (a-b)(a+b) \\ (-a-b)^2 = (a+b)^2 \\ (b-a)^2 = (a-b)^2 \\ \text{–í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–∞: } x^2+2x+1 \\ \text{–†–∞–∑–Ω–æ—Å—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–æ–≤: } 4x^2-9` },
                { title: "5. –§–°–£ (–ö—É–±—ã)", content: String.raw`(a+b)^3 = a^3+3a^2b+3ab^2+b^3 \\ (a-b)^3 = a^3-3a^2b+3ab^2-b^3 \\ a^3+b^3 = (a+b)(a^2-ab+b^2) \\ a^3-b^3 = (a-b)(a^2+ab+b^2) \\ \text{–°—É–º–º–∞ –∫—É–±–æ–≤} \\ \text{–†–∞–∑–Ω–æ—Å—Ç—å –∫—É–±–æ–≤} \\ \text{–ö—É–± —Å—É–º–º—ã/—Ä–∞–∑–Ω–æ—Å—Ç–∏}` },
                { title: "6. –§—É–Ω–∫—Ü–∏–∏", content: String.raw`y = f(x) \\ y = kx+b \\ k = \text{—É–≥–ª–æ–≤–æ–π –∫–æ—ç—Ñ.} \\ b = \text{–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ OY} \\ k_1=k_2 \Rightarrow \text{–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã} \\ y = kx \text{ (—á–µ—Ä–µ–∑ 0;0)} \\ \text{–ì—Ä–∞—Ñ–∏–∫: –ø—Ä—è–º–∞—è –ø–æ 2 —Ç–æ—á–∫–∞–º}` },
                { title: "7. –ì–µ–æ–º–µ—Ç—Ä–∏—è 7 –∫–ª", content: String.raw`Sum \angle \triangle = 180^\circ \\ \alpha+\beta = 180^\circ \text{ (—Å–º–µ–∂)} \\ \triangle \text{ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ: –°–£–°, –£–°–£, –°–°–°} \\ \text{–ú–µ–¥–∏–∞–Ω–∞, –ë–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞, –í—ã—Å–æ—Ç–∞} \\ c^2 < a^2+b^2 \text{ (–æ—Å—Ç—Ä–æ—É–≥)} \\ \text{–í–Ω–µ—à–Ω–∏–π } \angle = \text{—Å—É–º–º–∞ –¥–≤—É—Ö –≤–Ω—É—Ç—Ä.} \\ \text{–ü—Ä—è–º–æ—É–≥ } \triangle: \angle 1+\angle 2=90^\circ` }
            ],
            8: [
                { title: "1. –†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥—Ä–æ–±–∏", content: String.raw`\frac{A}{B} \text{ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø—Ä–∏ } B \neq 0 \\ \frac{A}{C} \pm \frac{B}{C} = \frac{A \pm B}{C} \\ \frac{A}{B} \cdot \frac{C}{D} = \frac{AC}{BD} \\ \frac{A}{B} : \frac{C}{D} = \frac{AD}{BC} \\ \frac{A}{B} = \frac{AK}{BK} \\ \text{–ó–Ω–∞–∫: } -\frac{a}{b} = \frac{-a}{b} = \frac{a}{-b} \\ \text{–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –ø–æ –§–°–£}` },
                { title: "2. –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –∫–æ—Ä–Ω–∏", content: String.raw`\sqrt{a} \ge 0, (\sqrt{a})^2 = a \\ \sqrt{a^2} = |a| \\ \sqrt{ab} = \sqrt{a}\sqrt{b} \\ \sqrt{a/b} = \sqrt{a}/\sqrt{b} \\ \sqrt{a^{2n}} = a^n \\ \text{–ò—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: } \frac{1}{\sqrt{a}} = \frac{\sqrt{a}}{a} \\ \text{–°—Ä–∞–≤–Ω–µ–Ω–∏–µ: } a < b \Rightarrow \sqrt{a} < \sqrt{b}` },
                { title: "3. –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è", content: String.raw`ax^2+bx+c=0 \\ D = b^2-4ac \\ x = \frac{-b \pm \sqrt{D}}{2a} \\ \text{–í–∏–µ—Ç: } x_1+x_2 = -b/a, x_1x_2 = c/a \\ ax^2+bx+c = a(x-x_1)(x-x_2) \\ x^2=a \Rightarrow x = \pm \sqrt{a} \\ \text{–ë–∏–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ: } ax^4+bx^2+c=0` },
                { title: "4. –ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞", content: String.raw`a > b, c > 0 \Rightarrow ac > bc \\ a > b, c < 0 \Rightarrow ac < bc \\ a > b, b > c \Rightarrow a > c \\ |x| < a \Rightarrow -a < x < a \\ |x| > a \Rightarrow x < -a \cup x > a \\ \text{–°–ª–æ–∂–µ–Ω–∏–µ: } a>b, c>d \Rightarrow a+c>b+d \\ \text{–ú–µ—Ç–æ–¥ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤}` },
                { title: "5. –°—Ç–µ–ø–µ–Ω–∏ –∏ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∏–¥", content: String.raw`a^{-n} = 1/a^n \\ (a/b)^{-n} = (b/a)^n \\ \text{–°—Ç–∞–Ω–¥–∞—Ä—Ç: } a \cdot 10^n, 1 \le a < 10 \\ 10^{-3} = 0,001 \\ \text{–ü–æ—Ä—è–¥–æ–∫ —á–∏—Å–ª–∞: } n \\ \text{–£–º–Ω–æ–∂–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π: } 10^k \cdot 10^m = 10^{k+m} \\ (10^k)^m = 10^{km}` },
                { title: "6. –ß–µ—Ç—ã—Ä–µ—Ö—É–≥–æ–ª—å–Ω–∏–∫–∏", content: String.raw`S_{–ø–∞—Ä} = ah = ab \sin \alpha \\ S_{—Ä–æ–º–±} = 0,5 d_1 d_2 \\ S_{—Ç—Ä–∞–ø} = \frac{a+b}{2}h \\ S_{–ø—Ä—è–º} = ab \\ S_{–∫–≤} = a^2 \\ \text{–ü–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º: } \angle 1+\angle 2 = 180^\circ \\ \text{–†–æ–º–±: –¥–∏–∞–≥–æ–Ω–∞–ª–∏ } \perp` },
                { title: "7. –¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ (–ü–∏—Ñ–∞–≥–æ—Ä)", content: String.raw`a^2+b^2=c^2 \\ \sin \alpha = a/c, \cos \alpha = b/c \\ tg \alpha = a/b, ctg \alpha = b/a \\ \sin^2 + \cos^2 = 1 \\ S = 0,5 ab \sin \gamma \\ S = \sqrt{p(p-a)(p-b)(p-c)} \\ \text{–°—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è: } 0,5 a` }
            ],
            9: [
                { title: "1. –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è", content: String.raw`y = ax^2+bx+c \\ x_0 = -b/2a \\ y_0 = f(x_0) \\ \text{–í–µ—Ç–≤–∏ –≤–≤–µ—Ä—Ö: } a > 0 \\ \text{–í–µ—Ç–≤–∏ –≤–Ω–∏–∑: } a < 0 \\ \text{–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ OY: } (0;c) \\ \text{–ö–æ—Ä–Ω–∏: —Ç–æ—á–∫–∏ –Ω–∞ OX}` },
                { title: "2. –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–∏", content: String.raw`a_n = a_1+d(n-1) \\ d = a_{n+1}-a_n \\ S_n = \frac{a_1+a_n}{2}n = \frac{2a_1+d(n-1)}{2}n \\ b_n = b_1 \cdot q^{n-1} \\ q = b_{n+1}/b_n \\ S_n = \frac{b_1(q^n-1)}{q-1} \\ S = \frac{b_1}{1-q} \text{ (–±–µ—Å–∫)}` },
                { title: "3. –¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è 9 –∫–ª", content: String.raw`a/\sin A = b/\sin B = c/\sin C = 2R \\ a^2 = b^2+c^2-2bc \cos A \\ \sin(180-x) = \sin x \\ \cos(180-x) = -\cos x \\ S = 0,5 ab \sin C \\ S = abc/4R \\ S = pr` },
                { title: "4. –í–µ–∫—Ç–æ—Ä—ã", content: String.raw`|\vec{a}| = \sqrt{x^2+y^2} \\ \vec{a}+\vec{b} = (x_1+x_2; y_1+y_2) \\ \vec{a} \cdot \vec{b} = x_1x_2+y_1y_2 \\ \vec{a} \cdot \vec{b} = |\vec{a}||\vec{b}| \cos \alpha \\ \vec{a} \perp \vec{b} \Rightarrow \vec{a} \cdot \vec{b} = 0 \\ \vec{a} \parallel \vec{b} \Rightarrow x_1/x_2 = y_1/y_2 \\ k\vec{a} = (kx; ky)` },
                { title: "5. –û–∫—Ä—É–∂–Ω–æ—Å—Ç—å (—É–≥–ª—ã)", content: String.raw`(x-x_0)^2+(y-y_0)^2 = R^2 \\ \angle_{—Ü–µ–Ω—Ç—Ä} = \cup \\ \angle_{–≤–ø–∏—Å–∞–Ω} = 0,5 \cup \\ \angle \text{ –Ω–∞ –¥–∏–∞–º–µ—Ç—Ä } = 90^\circ \\ \text{–ö–∞—Å–∞—Ç–µ–ª—å–Ω–∞—è } \perp \text{ —Ä–∞–¥–∏—É—Å—É} \\ a \cdot b = c \cdot d \text{ (—Ö–æ—Ä–¥—ã)} \\ \text{–û—Ç—Ä–µ–∑–∫–∏ –∫–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–≤–Ω—ã}` },
                { title: "6. –ú–Ω–æ–≥–æ—É–≥–æ–ª—å–Ω–∏–∫–∏", content: String.raw`Sum \angle = 180(n-2) \\ \angle_{–ø—Ä–∞–≤–∏–ª} = \frac{180(n-2)}{n} \\ R_6 = a \\ r_4 = a/2 \\ a_3 = R\sqrt{3} \\ S = 0,5 P_{ext} r \\ \text{–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π } \angle = 360/n` },
                { title: "7. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å", content: String.raw`P(A) = m/n \\ P(\bar{A}) = 1-P(A) \\ \text{–†–∞–∑–º–∞—Ö: } max-min \\ \text{–ú–µ–¥–∏–∞–Ω–∞: —Å–µ—Ä–µ–¥–∏–Ω–∞ —Ä—è–¥–∞} \\ \text{–ú–æ–¥–∞: —á–∞—â–µ –≤—Å–µ–≥–æ} \\ \text{–î–∏—Å–ø–µ—Ä—Å–∏—è: —Ä–∞–∑–±—Ä–æ—Å} \\ \text{–ß–∞—Å—Ç–æ—Ç–∞: } m/N` }
            ],
            10: [
                { title: "1. –¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è (–¢–æ–∂–¥–µ—Å—Ç–≤–∞)", content: String.raw`\sin^2 + \cos^2 = 1 \\ tg \cdot ctg = 1 \\ 1+tg^2 = 1/\cos^2 \\ 1+ctg^2 = 1/\sin^2 \\ tg = \sin/\cos \\ ctg = \cos/\sin \\ \sin(-x) = -\sin x` },
                { title: "2. –§–æ—Ä–º—É–ª—ã —Å–ª–æ–∂–µ–Ω–∏—è", content: String.raw`\sin(a \pm b) = \sin a \cos b \pm \cos a \sin b \\ \cos(a \pm b) = \cos a \cos b \mp \sin a \sin b \\ tg(a \pm b) = \frac{tg a \pm tg b}{1 \mp tg a tg b} \\ \sin 2a = 2\sin a \cos a \\ \cos 2a = \cos^2 a - \sin^2 a \\ \cos 2a = 2\cos^2 a - 1 \\ \cos 2a = 1 - 2\sin^2 a` },
                { title: "3. –¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è", content: String.raw`\sin x = a \Rightarrow x = (-1)^k \arcsin a + \pi k \\ \cos x = a \Rightarrow x = \pm \arccos a + 2\pi k \\ tg x = a \Rightarrow x = arctg a + \pi k \\ ctg x = a \Rightarrow x = arcctg a + \pi k \\ \sin x = 0 \Rightarrow \pi k \\ \cos x = 0 \Rightarrow \pi/2 + \pi k \\ \sin x = 1 \Rightarrow \pi/2 + 2\pi k` },
                { title: "4. –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è (–±–∞–∑–∞)", content: String.raw`C' = 0 \\ x' = 1 \\ (x^n)' = nx^{n-1} \\ (\sin x)' = \cos x \\ (\cos x)' = -\sin x \\ (tg x)' = 1/\cos^2 x \\ (e^x)' = e^x` },
                { title: "5. –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π", content: String.raw`(u \pm v)' = u' \pm v' \\ (u \cdot v)' = u'v + uv' \\ (u/v)' = \frac{u'v-uv'}{v^2} \\ (Cu)' = Cu' \\ (f(g(x)))' = f'(g) \cdot g'(x) \\ \text{–§–∏–∑–∏—á. —Å–º—ã—Å–ª: } v(t) = s'(t) \\ \text{–£—Å–∫–æ—Ä–µ–Ω–∏–µ: } a(t) = v'(t)` },
                { title: "6. –°—Ç–µ—Ä–µ–æ–º–µ—Ç—Ä–∏—è (–ü—Ä–∏–∑–º—ã)", content: String.raw`V = S_{–æ—Å–Ω} h \\ S_{–±–æ–∫} = P_{–æ—Å–Ω} h \\ d^2 = a^2+b^2+c^2 \text{ (–ø–∞—Ä–∞–ª)} \\ S_{–ø–æ–ª–Ω} = S_{–±–æ–∫} + 2S_{–æ—Å–Ω} \\ \text{–ü—Ä–∏–∑–º–∞: –æ—Å–Ω–æ–≤–∞–Ω–∏—è } \parallel \\ \text{–¢–¢–ü: —Ç—Ä–∏ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–∞} \\ \text{–£–≥–æ–ª –º–µ–∂–¥—É –ø—Ä—è–º—ã–º–∏}` },
                { title: "7. –ü–∏—Ä–∞–º–∏–¥—ã –∏ –ö–æ–Ω—É—Å—ã", content: String.raw`V = \frac{1}{3} S_{–æ—Å–Ω} h \\ S_{–±–æ–∫} = 0,5 P_{–æ—Å–Ω} l \text{ (–∞–ø–æ—Ñ–µ–º–∞)} \\ V_{–∫–æ–Ω—É—Å} = \frac{1}{3} \pi r^2 h \\ S_{–±–æ–∫\_–∫–æ–Ω—É—Å} = \pi rl \\ l^2 = r^2+h^2 \\ \text{–í–µ—Ä—à–∏–Ω–∞ –Ω–∞–¥ —Ü–µ–Ω—Ç—Ä–æ–º} \\ \text{–û–±—ä–µ–º —Ü–∏–ª–∏–Ω–¥—Ä–∞: } \pi r^2 h` }
            ],
            11: [
                { title: "1. –õ–æ–≥–∞—Ä–∏—Ñ–º—ã (–±–∞–∑–∞)", content: String.raw`a^{\log_a b} = b \\ \log_a bc = \log_a b + \log_a c \\ \log_a (b/c) = \log_a b - \log_a c \\ \log_a b^n = n \log_a b \\ \log_{a^k} b = \frac{1}{k} \log_a b \\ \log_a b = \frac{\log_c b}{\log_c a} \\ \ln x = \log_e x` },
                { title: "2. –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è", content: String.raw`\log_a f(x) = b \Rightarrow f(x) = a^b \\ \log_a f(x) = \log_a g(x) \Rightarrow f=g, f>0 \\ \text{–ú–µ—Ç–æ–¥ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥–ª—è } \log \\ \text{–û–î–ó: } a>0, a \neq 1, f(x)>0 \\ \log_{x} a \Rightarrow x>0, x \neq 1 \\ \text{–ó–∞–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: } t = \log_a x \\ \text{–°–≤–æ–π—Å—Ç–≤–æ: } a^{\log_c b} = b^{\log_c a}` },
                { title: "3. –†–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è (–ï–ì–≠ ‚Ññ15)", content: String.raw`(h-1)(f-g) \gtrless 0 \text{ –¥–ª—è } \log_h f - \log_h g \\ |f|-|g| \Rightarrow (f-g)(f+g) \\ h(x)^{f(x)} \dots h(x)^{g(x)} \Rightarrow (h-1)(f-g) \\ \frac{\log_a f - \log_a g}{h} \Rightarrow \frac{f-g}{h} \\ \log_f h - 1 \Rightarrow (f-1)(h-1) \\ \text{–£—á–µ—Ç –û–î–ó –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!} \\ \text{–ú–µ—Ç–æ–¥ –∑–Ω–∞–∫–∞}` },
                { title: "4. –û–±—ä–µ–º—ã –∏ –ü–ª–æ—â–∞–¥–∏ —Ç–µ–ª", content: String.raw`V_{—à–∞—Ä} = \frac{4}{3} \pi r^3 \\ S_{—Å—Ñ–µ—Ä–∞} = 4\pi r^2 \\ V_{—Ü–∏–ª} = \pi r^2 h \\ S_{–±–æ–∫\_—Ü–∏–ª} = 2\pi rh \\ S_{–ø–æ–ª–Ω\_—Ü–∏–ª} = 2\pi r(r+h) \\ V_{–∫–æ–Ω—É—Å} = \frac{1}{3} \pi r^2 h \\ S_{–ø–æ–ª–Ω\_–∫–æ–Ω—É—Å} = \pi r(r+l)` },
                { title: "5. –ö–∞—Å–∞—Ç–µ–ª—å–Ω–∞—è –∏ –ò–Ω—Ç–µ–≥—Ä–∞–ª", content: String.raw`y = f(x_0) + f'(x_0)(x-x_0) \\ k = tg \alpha = f'(x_0) \\ \int x^n dx = \frac{x^{n+1}}{n+1} + C \\ \int \frac{1}{x} dx = \ln|x| + C \\ \int e^x dx = e^x + C \\ \int \cos x dx = \sin x + C \\ S = \int_a^b (f-g) dx` },
                { title: "6. –≠–∫–æ–Ω–æ–º–∏–∫–∞ (–ï–ì–≠ ‚Ññ16)", content: String.raw`X = S \cdot \frac{k^n(k-1)}{k^n-1} \text{ (–ê–Ω–Ω—É–∏—Ç–µ—Ç)} \\ k = 1 + r/100 \\ \text{–î–∏—Ñ—Ñ: –æ—Å—Ç–∞—Ç–æ–∫ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ} \\ \text{–ü–µ—Ä–µ–ø–ª–∞—Ç–∞: } \sum \text{–≤—ã–ø–ª–∞—Ç} - S \\ \text{–î–æ—Ö–æ–¥: } –í—ã—Ä—É—á–∫–∞ - –ó–∞—Ç—Ä–∞—Ç—ã \\ \text{–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è } = 0 \\ \text{–°–ª–æ–∂–Ω—ã–π \%: } S(1+r/100)^n` },
                { title: "7. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ", content: String.raw`z = a+bi \\ i^2 = -1 \\ |z| = \sqrt{a^2+b^2} \\ (x-a)^2+(y-b)^2 = R^2 \text{ (–≥—Ä–∞—Ñ. –º–µ—Ç–æ–¥)} \\ \text{–°–≤–æ–π—Å—Ç–≤–∞ } D \text{ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö} \\ f(x)=a \text{ (–º–µ—Ç–æ–¥ —Å–¥–≤–∏–≥–∞)} \\ \text{–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å: } x \to -x` }
            ]
        };

        let state = { name: localStorage.getItem('school_user_name') || "", class: localStorage.getItem('school_user_class') || 0, lives: 5, coins: parseInt(localStorage.getItem('school_user_coins')) || 0, currentQuestions: [], currentQIndex: 0 };
        if (state.name) document.getElementById('username-input').value = state.name;

        function showScreen(id) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0,0); }
        function selectClass(cls) { const n = document.getElementById('username-input').value; if (!n) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è!"); state.name = n; state.class = cls; localStorage.setItem('school_user_name', n); localStorage.setItem('school_user_class', cls); document.body.className = `class-${cls}`; document.getElementById('welcome-text').innerText = `–ö—É—Ä—Å–∞–Ω—Ç ${n}, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤ —Å–µ–∫—Ç–æ—Ä–µ ${cls}!`; updateStats(); showScreen('screen-menu'); }
        function changeClass() { showScreen('screen-welcome'); }
        function updateStats() { ['lives-display', 'coins-display', 'quiz-lives', 'quiz-coins'].forEach(id => { const el = document.getElementById(id); if (el) el.innerText = id.includes('lives') ? state.lives : state.coins; }); localStorage.setItem('school_user_coins', state.coins); }

        function showTheorySelection() { 
            const l = document.getElementById('topics-list'); l.innerHTML = ""; 
            const topics = theoryData[state.class] || []; 
            topics.forEach((t, idx) => { 
                const b = document.createElement('button'); b.className = "btn"; b.innerText = t.title; 
                b.onclick = () => { 
                    const c = document.getElementById('theory-content'); 
                    c.innerHTML = `<h3>${t.title}</h3><div id="m"></div>`; 
                    katex.render(t.content, document.getElementById('m'), { displayMode: true, throwOnError: false }); 
                    showScreen('screen-theory-read'); 
                }; l.appendChild(b); 
            }); showScreen('screen-theory-select'); 
        }

        async function startPractice() { 
            state.lives = 5; state.currentQIndex = 0; showScreen('screen-practice'); 
            try { 
                const res = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vSyYBIArwn-npZYPgPwIazi4HzVR4DzusAc1VvJ_eQklHkYBElS7r0pwZzx-Pe2tPnoop9sFBpFMZWj/pub?output=csv"); 
                const csv = await res.text(); 
                const rows = csv.split(/\r?\n/).filter(l => l.trim() !== "").slice(1).map(l => l.split(',')); 
                const filtered = rows.filter(r => r[0] && r[0].trim() == state.class.toString()); 
                state.currentQuestions = filtered.sort(() => 0.5 - Math.random()).slice(0, parseInt(state.class) <= 7 ? 5 : 10); 
                renderQuestion(); 
            } catch (e) { alert("–°–≤—è–∑—å –ø–æ—Ç–µ—Ä—è–Ω–∞!"); showScreen('screen-menu'); } 
        }

        function renderQuestion() { 
            document.getElementById('feedback-block').style.display = 'none'; 
            const q = state.currentQuestions[state.currentQIndex]; 
            if (!q) return finishQuiz(true); 
            const qTextEl = document.getElementById('question-text');
            qTextEl.innerHTML = q[1]; 
            renderMathInElement(qTextEl, { delimiters: [{left: "$", right: "$", display: false}] });
            const b = document.getElementById('answers-block'); b.innerHTML = ""; 
            [q[2], q[3], q[4], q[5]].forEach((opt, i) => { 
                if (opt && opt.trim()) { 
                    const btn = document.createElement('button'); btn.className = "btn"; 
                    btn.style.background = "#fff"; btn.style.color = "#000"; 
                    btn.innerHTML = opt.replace(/"/g, "").trim(); 
                    renderMathInElement(btn, { delimiters: [{left: "$", right: "$", display: false}] });
                    btn.onclick = () => { 
                        const corr = parseInt(q[6].replace(/\D/g, "")); 
                        document.querySelectorAll('#answers-block .btn').forEach(btn => btn.disabled = true); 
                        if (i + 1 === corr) { btn.style.background = "#2ecc71"; state.coins += 10; document.getElementById('feedback-title').innerText = "‚úÖ –í–µ—Ä–Ω–æ!"; } 
                        else { btn.style.background = "#e74c3c"; state.lives--; document.getElementById('feedback-title').innerText = "‚ùå –û—à–∏–±–∫–∞!"; } 
                        const solEl = document.getElementById('feedback-solution');
                        solEl.innerHTML = q[7] || "–†–µ—à–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è..."; 
                        renderMathInElement(solEl, { delimiters: [{left: "$", right: "$", display: false}] });
                        document.getElementById('feedback-block').style.display = "block"; 
                        document.getElementById('next-q-btn').onclick = () => { state.currentQIndex++; if (state.lives > 0) renderQuestion(); else finishQuiz(false); }; 
                        updateStats(); 
                    }; b.appendChild(btn); 
                } 
            }); 
        }

        function finishQuiz(w) { showScreen('screen-results'); document.getElementById('result-message').innerText = w ? "–ú–∏—Å—Å–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞! üéâ" : "–¢–æ–ø–ª–∏–≤–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å... üíÄ"; updateStats(); }
    </script>
</body>
</html>